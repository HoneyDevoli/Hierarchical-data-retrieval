# Иерархическое получение данных
## Задание

Необходимо импортировать данные по организациям и пользователям в SQL таблицу из приложенного к заданию json файла.
У компании есть офисы (type = 1) в нескольких городах, в каждом из них  есть отделы (type = 2), где работают сотрудники (type = 3). Необходимо реализовать выборку всех сотрудников по указанному идентификатору сотрудника.

## Сложности выборки и оптимизации

### Текущие проблемы

1. Сложность рекурсивного sql запроса 
2. Все данные хранятся в одной таблице
3. Нет консистентности данных, потенциально можно решить эту проблему триггером
4. Нет возможности сделать уникальный ид, потому что есть связь id и parentid, поэтому если мы загрузим второй раз теже данные мы не получим корректную выборку в том числе

### Предложения по оптимизации

Провести нормализацию данных
1. Разделить информацию по таблицам office, department, employee
2. Создать таблицу со связью office_department
3. В таблице employee привязать пользователя к таблице department по внешнему ключу

Так же можно применить расширение _ltree_ для ускорения/индексации запросов

## Установка

C помощью команды _setup.py_

```bash
python setup.py install
```

Создаем новую базу с помощью sql команды

```sql
create database название_базы
```

Указываем в _emploeyees/config.py_ название бд, юзера и пароль

## Использование

Создает таблицу в бд и загружает данные из файла, принимает путь к файлу, путь по умолчанию это корень проекта

```bash
init-db
```

Возвращает список сотрудников по айди сотрудника

```bash
get-names 4
>>> ['Иванов', 'Сидоров', 'Петров']
```